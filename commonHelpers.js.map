{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/loadMoreService.js","../src/js/refs.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '44841461-2c7fd944dee0b14672f32444a';\n\nasync function fetchImages({ q = '', page = 1, per_page = 15 } = {}) {\n    return (await axios.get('https://pixabay.com/api/', {\n        params: {\n            key: API_KEY,\n            q,\n            image_type: 'photo',\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page\n        }\n    })).data\n}\nexport default fetchImages","\nfunction renderMarkup(hits) {\n\n  const markup = hits.map(({ largeImageURL, webformatURL, tags, views, downloads, likes, comments }) => {\n    return `<li class=\"gallery-item\">\n    <a  class=\"gallery-link\" href=${largeImageURL}><img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" width=\"360\" height=\"200\"></a>\n    <div>\n      <ul class=\"description-list\">\n        <li><p class=\"description-element\">Like<br><span>${likes}</span></p></li>\n        <li><p class=\"description-element\">Views<br><span>${views}</span></p></li>\n        <li><p class=\"description-element\">Comments<br><span>${comments}</span></p></li>\n        <li><p class=\"description-element\">Downloads<br><span>${downloads}</span></p></li>\n      </ul>\n      </img>\n  </li>\n  </div>`;\n  }).join(' ');\n  return markup;\n}\n\nexport default renderMarkup;","const hiddenClass = \"is-hidden\";\n\nfunction hide(button) {\n    button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n    button.classList.remove(hiddenClass);\n}\n\nfunction disabled(button) {\n    button.disabled = true;\n    // spinner.classList.remove(hiddenClass);\n}\n\nfunction enable(button) {\n    button.disabled = false;\n    // spinner.classList.add(hiddenClass);\n}\n\nexport default { hide, show, disabled, enable }","'use strict'\n\nconst elements = {\n    gallery: document.querySelector('.gallery'),\n    form: document.querySelector('.js-form'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.js-load-more'),\n    spinner: document.querySelector('.loader')\n};\n\nexport default elements","const emptyInput = 'Sorry, please enter text';\nconst emptySearchQuery = 'Sorry, there are not no images matching your search query';\nconst errorFetch = 'Oops'\n\nimport fetchImages from \"./js/pixabay-api\"\nimport renderMarkup from \"./js/render-functions\"\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport buttonService from './js/loadMoreService'\nimport refs from \"./js/refs\"; './js/refs'\nconst { gallery, form, loader, loadMoreBtn } = refs;\n\nconst params = {\n    q: '',\n    page: 1,\n    per_page: 15,\n    maxPage: 0\n}\nbuttonService.hide(loadMoreBtn)\n\nform.addEventListener('submit', handleSubmitForm)\ngallery.addEventListener('click', handleClick)\n\nfunction handleClick(evt) {\n    evt.preventDefault()\n    if (evt.target.nodeName !== \"IMG\") {\n        return\n    }\n    new SimpleLightbox('.gallery a', { captionDelay: 250, captionPosition: 'bottom', captionsData: \"alt\" });\n\n}\n\nfunction handleSubmitForm(evt) {\n    evt.preventDefault()\n    gallery.innerHTML = '';\n    params.page = 1\n    params.q = evt.currentTarget.children.query.value\n    if (!params.q.trim().length) {\n        return createAlertMessages(\"Warning\", emptyInput)\n    }\n    loader.classList.remove('visually-hidden')\n    fetchImages(params)\n        .then(({ total, totalHits, hits }) => {\n            params.maxPage = Math.ceil(totalHits / params.per_page)\n            gallery.insertAdjacentHTML('beforeend', renderMarkup(hits))\n            buttonService.show(loadMoreBtn)\n            buttonService.disabled(loadMoreBtn)\n            if (hits.length > 0 && hits.length * params.page !== totalHits) {\n                buttonService.enable(loadMoreBtn)\n                loadMoreBtn.addEventListener('click', handleLoadMore)\n            }\n            else {\n                createAlertMessages('Warning', emptySearchQuery)\n                buttonService.hide(loadMoreBtn)\n            }\n        })\n        .catch(error => createAlertMessages('Error', errorFetch, error))\n        .finally(() => {\n            loader.classList.add('visually-hidden')\n            form.reset()\n        })\n}\n\nfunction handleLoadMore() {\n    params.page += 1\n    scrollGallery()\n    const loaderMore = loadMoreBtn.nextElementSibling\n    loaderMore.classList.remove('visually-hidden')\n    fetchImages(params)\n        .then(({ hits }) => {\n            gallery.insertAdjacentHTML('beforeend', renderMarkup(hits))\n        })\n        .catch(error => createAlertMessages('Error', errorFetch, error))\n        .finally(() => {\n            buttonService.enable(loadMoreBtn)\n            loaderMore.classList.add('visually-hidden')\n            if (params.page === params.maxPage) {\n                buttonService.hide(loadMoreBtn);\n                loadMoreBtn.removeAttribute('click', handleLoadMore)\n                createAlertMessages(\"Error\", \"We're sorry, but you've reached the end of search results.\")\n            }\n        })\n}\n\nfunction createAlertMessages(typeMessage, alertMessage, typeError = null) {\n    return iziToast.warning({\n        title: `${typeMessage}`,\n        message: typeError ? `${alertMessage} ${typeError} ` : `${alertMessage}`,\n    })\n}\n\nfunction scrollGallery() {\n    const targetElement = gallery.lastElementChild;\n\n    const rect = targetElement.getBoundingClientRect();\n    const galleryRect = gallery.getBoundingClientRect();\n\n    window.scrollBy({\n        top: rect.top - galleryRect.top + window.scrollY,\n        behavior: 'smooth'\n    });\n}"],"names":["API_KEY","fetchImages","q","page","per_page","axios","renderMarkup","hits","largeImageURL","webformatURL","tags","views","downloads","likes","comments","hiddenClass","hide","button","show","disabled","enable","buttonService","elements","emptyInput","emptySearchQuery","errorFetch","gallery","form","loader","loadMoreBtn","refs","params","handleSubmitForm","handleClick","evt","SimpleLightbox","createAlertMessages","total","totalHits","handleLoadMore","error","scrollGallery","loaderMore","typeMessage","alertMessage","typeError","iziToast","rect","galleryRect"],"mappings":"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"}