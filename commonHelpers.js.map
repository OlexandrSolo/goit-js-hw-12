{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/loadMoreService.js","../src/js/refs.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '44841461-2c7fd944dee0b14672f32444a';\n\nasync function fetchImages({ q = '', page = 1, per_page = 15 } = {}) {\n    return (await axios.get('https://pixabay.com/api/', {\n        params: {\n            key: API_KEY,\n            q,\n            image_type: 'photo',\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page\n        }\n    })).data\n}\nexport default fetchImages","\nfunction renderMarkup(hits) {\n\n  const markup = hits.map(({ largeImageURL, webformatURL, tags, views, downloads, likes, comments }) => {\n    return `<li class=\"gallery-item\">\n    <a  class=\"gallery-link\" href=${largeImageURL}><img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" width=\"360\" height=\"200\"></a>\n    <div>\n      <ul class=\"description-list\">\n        <li><p class=\"description-element\">Like<br><span>${likes}</span></p></li>\n        <li><p class=\"description-element\">Views<br><span>${views}</span></p></li>\n        <li><p class=\"description-element\">Comments<br><span>${comments}</span></p></li>\n        <li><p class=\"description-element\">Downloads<br><span>${downloads}</span></p></li>\n      </ul>\n      </img>\n  </li>\n  </div>`;\n  }).join(' ');\n  return markup;\n}\n\nexport default renderMarkup;","const hiddenClass = \"is-hidden\";\n\nfunction hide(button) {\n    button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n    button.classList.remove(hiddenClass);\n}\n\nfunction disabled(button) {\n    button.disabled = true;\n    // spinner.classList.remove(hiddenClass);\n}\n\nfunction enable(button) {\n    button.disabled = false;\n    // spinner.classList.add(hiddenClass);\n}\n\nexport default { hide, show, disabled, enable }","'use strict'\n\nconst elements = {\n    gallery: document.querySelector('.gallery'),\n    form: document.querySelector('.js-form'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.js-load-more'),\n    spinner: document.querySelector('.loader')\n};\n\nexport default elements","const emptyInput = 'Sorry, please enter text';\nconst emptySearchQuery = 'Sorry, there are not no images matching your search query';\nconst errorFetch = 'Oops'\n\nimport fetchImages from \"./js/pixabay-api\"\nimport renderMarkup from \"./js/render-functions\"\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport buttonService from './js/loadMoreService'\nimport refs from \"./js/refs\"; './js/refs'\n\nconst params = {\n    q: '',\n    page: 1,\n    per_page: 15,\n    maxPage: 0\n}\nbuttonService.hide(refs.loadMoreBtn)\n\nrefs.form.addEventListener('submit', handleSubmitForm)\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore)\nconst lightbox = new SimpleLightbox('.gallery a', { captionDelay: 250, captionPosition: 'bottom', captionsData: \"alt\" });\n\n// переробити функція прибравши then, catch, поставити try catch в середину яких буде поміщено конструкцію async await\nfunction handleSubmitForm(evt) {\n    evt.preventDefault()\n    refs.gallery.innerHTML = '';\n    params.page = 1\n    params.q = evt.currentTarget.children.query.value\n    if (!params.q.trim().length) {\n        return createAlertMessages(\"Warning\", emptyInput)\n    }\n    refs.loader.classList.remove('visually-hidden')\n    fetchImages(params)\n        .then(({ total, totalHits, hits }) => {\n            params.maxPage = Math.ceil(totalHits / params.per_page)\n            refs.gallery.insertAdjacentHTML('beforeend', renderMarkup(hits))\n            lightbox.refresh()\n            buttonService.show(refs.loadMoreBtn)\n            buttonService.disabled(refs.loadMoreBtn)\n            if (hits.length > 0 && hits.length * params.page !== totalHits) {\n                buttonService.enable(refs.loadMoreBtn)\n            }\n            else {\n                createAlertMessages('Warning', emptySearchQuery)\n                buttonService.hide(refs.loadMoreBtn)\n            }\n        })\n        .catch(error => createAlertMessages('Error', errorFetch, error))\n        .finally(() => {\n            refs.loader.classList.add('visually-hidden')\n            refs.form.reset()\n        })\n}\n\nfunction handleLoadMore() {\n    params.page += 1\n    const loaderMore = refs.loadMoreBtn.nextElementSibling\n    loaderMore.classList.remove('visually-hidden')\n    fetchImages(params)\n        .then(({ hits }) => {\n            refs.gallery.insertAdjacentHTML('beforeend', renderMarkup(hits))\n            scrollGallery()\n        })\n        .catch(error => createAlertMessages('Error', errorFetch, error))\n        .finally(() => {\n            buttonService.enable(refs.loadMoreBtn)\n            loaderMore.classList.add('visually-hidden')\n            if (params.page === params.maxPage) {\n                buttonService.hide(refs.loadMoreBtn);\n                refs.loadMoreBtn.removeAttribute('click', handleLoadMore)\n                createAlertMessages(\"Error\", \"We're sorry, but you've reached the end of search results.\")\n            }\n        })\n}\n\nfunction createAlertMessages(typeMessage, alertMessage, typeError = null) {\n    return iziToast.warning({\n        title: `${typeMessage}`,\n        message: typeError ? `${alertMessage} ${typeError} ` : `${alertMessage}`,\n    })\n}\n\nfunction scrollGallery() {\n    const cardHight = refs.gallery.lastElementChild.getBoundingClientRect().height\n\n    window.scrollBy({\n        top: cardHight * 2,\n        behavior: 'smooth'\n    });\n}"],"names":["API_KEY","fetchImages","q","page","per_page","axios","renderMarkup","hits","largeImageURL","webformatURL","tags","views","downloads","likes","comments","hiddenClass","hide","button","show","disabled","enable","buttonService","elements","emptyInput","emptySearchQuery","errorFetch","params","refs","handleSubmitForm","handleLoadMore","lightbox","SimpleLightbox","evt","createAlertMessages","total","totalHits","error","loaderMore","scrollGallery","typeMessage","alertMessage","typeError","iziToast","cardHight"],"mappings":"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"}